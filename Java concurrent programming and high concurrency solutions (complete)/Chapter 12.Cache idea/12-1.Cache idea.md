# 12 缓存思路

现阶段一般网络系统基本结构如图：

![](General_network_system_architecture.png)

然而由于越来越多的人访问，我们的网站并发量增大，因此需要缓存来帮助我们减少处理。

## 缓存特征

命中率：命中数/（没有命中数+命中数）

PS:命中指的是可以直接通过缓存获取到想要的数据

最大元素（空间）：缓存中可以存放的最大元素的数量，一般超过该值会删除某些缓存。

缓存清空策略：FIFO（先进先出策略，数据实时性场景下可以选择，优先保证最新数据可用）、LFU（最少使用策略，无论是否过期，清除使用次数最少的缓存，保证高频数据有效性场景下）、LRU（最近最少使用策略，无论是否过期，根据元素最近使用时间戳，删除最近最少用的，热点数据场景下）、过期时间，随机等

## 缓存命中率影响因素

1. 业务场景和业务需求：缓存适合于读多写少的业务需求。实时性越低越适合使用缓存。
2. 缓存的设计（粒度和策略）：粒度越小越容易命中。当数据发生变化时，直接更新缓存的值，比移除缓存或者让缓存过期，命中率更高。
3. 缓存的容量和基础设施（内置本机缓存，容易存在瓶颈，使用外置缓存，更易扩展）

## 缓存分类与应用场景

本地缓存：编程实现（成员变量、局部变量、静态变量）、Guava Cache

PS:缓存与应用在同一个进程内部，请求缓存非常的快速，没有过多的网络开销，但应用中不需要集群支持或者各节点不需要互相通知，但是各应用都需要自己维护缓存，造成内存浪费。

分布式缓存：Memcache、Redis

PS:应用分离的缓存组件或服务，本身就是一个独立的应用，与本地应用隔离，多个应用可以直接共享缓存。